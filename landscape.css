/* =============================================
   LANDSCAPE MODE SUPPORT
   iOS Safari ignores manifest orientation lock
   
   When body.compass-mode is set, show full screen map
   ============================================= */

@media screen and (orientation: landscape) {
    /* COMPASS MODE in landscape - full screen map */
    body.compass-mode .map-view-container {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 100vw !important;
        height: 100vh !important;
        z-index: 1 !important;
    }
    
    body.compass-mode #map-container {
        width: 250% !important;
        height: 250% !important;
        position: absolute !important;
        top: calc(50vh - 125%) !important;
        left: -75% !important;
        transform-origin: center center !important;
    }
    
    /* Hide panel completely in compass landscape mode */
    body.compass-mode .arrivals-panel {
        display: none !important;
    }
    
    /* Keep badges visible in compass mode */
    body.compass-mode .map-controls-stack {
        position: fixed !important;
        bottom: calc(16px + env(safe-area-inset-bottom)) !important;
        right: 16px !important;
        z-index: 1000 !important;
    }
    
    body.compass-mode .settings-badge {
        position: fixed !important;
        top: calc(16px + env(safe-area-inset-top)) !important;
        left: 16px !important;
        z-index: 1000 !important;
    }
    
    body.compass-mode .glass-header {
        position: fixed !important;
        top: calc(11px + env(safe-area-inset-top)) !important;
        right: 16px !important;
        left: auto !important;
        z-index: 1000 !important;
    }

    /* ============================================= */
    /* NORMAL LANDSCAPE MODE (not compass mode)     */
    /* ============================================= */
    
    /* Split screen: 60% map, 40% panel */
    
    /* Map takes left 60% - FULL HEIGHT */
    body:not(.compass-mode) .map-view-container {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 60vw !important;
        height: 100vh !important;
        bottom: 0 !important;
        z-index: 1 !important;
    }
    
    body:not(.compass-mode) #map-container {
        width: 100% !important;
        height: 100% !important;
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        transform: translate3d(0, 0, 0) !important;
    }
    
    /* Panel takes right 40% - static, no dragging */
    body:not(.compass-mode) .arrivals-panel {
        position: fixed !important;
        top: 0 !important;
        left: 60vw !important;
        right: 0 !important;
        bottom: 0 !important;
        width: 40vw !important;
        height: 100vh !important;
        transform: none !important;
        border-radius: 0 !important;
        padding: 16px !important;
        padding-top: 80px !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
        touch-action: pan-y !important;
        -webkit-overflow-scrolling: touch !important;
        z-index: 1001 !important;
    }
    
    /* Disable sheet grabber in landscape */
    body:not(.compass-mode) .sheet-grabber {
        display: none !important;
    }
    
    /* Header - top left of map */
    body:not(.compass-mode) .glass-header {
        position: fixed !important;
        top: calc(8px + env(safe-area-inset-top)) !important;
        left: 8px !important;
        right: auto !important;
        width: auto !important;
        z-index: 10200 !important;
    }
    
    /* Arabic title smaller in landscape */
    body:not(.compass-mode) .arabic-title {
        font-size: 1.1rem !important;
    }
    
    /* Settings gear - next to logo */
    body:not(.compass-mode) .settings-badge {
        position: fixed !important;
        top: calc(8px + env(safe-area-inset-top)) !important;
        left: auto !important;
        right: calc(40vw + 16px) !important;
    }
    
    /* Back button - top left */
    body:not(.compass-mode) .back-badge {
        position: fixed !important;
        top: calc(8px + env(safe-area-inset-top)) !important;
        left: 8px !important;
    }
    
    /* Map controls - bottom right of map area */
    body:not(.compass-mode) .map-controls-stack {
        position: fixed !important;
        top: auto !important;
        bottom: calc(16px + env(safe-area-inset-bottom)) !important;
        right: calc(40vw + 16px) !important;
        left: auto !important;
    }
    
    /* Walking time badge - top right of map area */
    body:not(.compass-mode) #walking-time {
        position: fixed !important;
        top: calc(60px + env(safe-area-inset-top)) !important;
        bottom: auto !important;
        right: calc(40vw + 16px) !important;
        left: auto !important;
    }
    
    /* Calorie badge - below walking time */
    body:not(.compass-mode) #calorie-badge {
        position: fixed !important;
        top: calc(110px + env(safe-area-inset-top)) !important;
        bottom: auto !important;
        right: calc(40vw + 16px) !important;
        left: auto !important;
    }
    
    /* Floating controls - top of panel */
    body:not(.compass-mode) #floating-controls {
        position: fixed !important;
        top: calc(8px + env(safe-area-inset-top)) !important;
        left: calc(60vw + 16px) !important;
        right: 16px !important;
        width: auto !important;
        z-index: 10100;
    }
    
    /* Quick actions - in panel, always visible */
    body:not(.compass-mode) .quick-actions-panel {
        position: relative !important;
        margin-top: 0 !important;
    }
    
    /* Routes list - scrollable */
    body:not(.compass-mode) .routes-list {
        overflow-y: auto !important;
        max-height: none !important;
        padding-bottom: 40px !important;
        touch-action: pan-y !important;
        -webkit-overflow-scrolling: touch !important;
    }
    
    /* Skyline - hide in landscape to save space */
    body:not(.compass-mode) .skyline-inline {
        display: none !important;
    }
    
    /* Crosshair - center of map area */
    body:not(.compass-mode) .map-crosshair {
        left: 30vw !important;
        top: 50vh !important;
        right: auto !important;
    }
    
    /* Distance circles - adjust for map width */
    body:not(.compass-mode) .distance-circle-label {
        font-size: 9px !important;
    }
    
    /* Station cards - adjust for narrower panel */
    body:not(.compass-mode) .station-card {
        padding: 12px !important;
    }
    
    body:not(.compass-mode) .station-name {
        font-size: 0.9rem !important;
    }
    
    /* Routes header */
    body:not(.compass-mode) .routes-header {
        padding: 12px 0 !important;
    }
    
    /* Detail overlay - adjust for panel */
    body:not(.compass-mode) .detail-bus-overlay-panel {
        left: calc(60vw + 16px) !important;
        right: 16px !important;
        width: auto !important;
    }
}
